#include "common.h"

//
// Structure definitions
//

struct v2p {
    vec4 color;
    vec2 tc0;
    vec2 tc1;
};


//
// Global variable definitions
//

uniform sampler2D s_clouds0;
uniform sampler2D s_clouds1;

//
// Function declarations
//

vec4 xlat_main( in v2p I );

//
// Function definitions
//

vec4 xlat_main( in v2p I ) {
    vec4 s0;
    vec4 s1;
    vec4 mix;
    float scale;
    vec4 rgb;
    vec4 hi;

    s0 = texture2D( s_clouds0, I.tc0);
    s1 = texture2D( s_clouds1, I.tc1);
    mix = (I.color * (s0 + s1));
    scale = texture2D( s_tonemap, vec2( 0.500000, 0.500000)).x ;
    tonemap( rgb, hi, vec3( mix), scale);
    return vec4( rgb.xyz , rgb.w );
}


//
// Translator's entry point
//
void main() {
    vec4 xlat_retVal;
    v2p xlat_temp_I;
    xlat_temp_I.color = vec4( gl_Color);
    xlat_temp_I.tc0 = vec2( gl_TexCoord[0]);
    xlat_temp_I.tc1 = vec2( gl_TexCoord[1]);

    xlat_retVal = xlat_main( xlat_temp_I);

    gl_FragData[0] = vec4( xlat_retVal);
}


